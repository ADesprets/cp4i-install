apiVersion: v1
kind: Secret
metadata:
  name: cp4imq-secret
  namespace: cp4i
data:
  tls.crt: LS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tCk1JSURZakNDQWtvQ0ZBWi80c1ZXOVJpMWRKWkZmMGxETG85TXdoOE1NQTBHQ1NxR1NJYjNEUUVCQ3dVQU1JR0EKTVFzd0NRWURWUVFHRXdKR1VqRU1NQW9HQTFVRUNBd0RTVVJHTVE0d0RBWURWUVFIREFWUVFWSkpVekVRTUE0RwpBMVVFQ2d3SFFrVk9RVU5JU1RFTk1Bc0dBMVVFQ3d3RVUwRkJSREVMTUFrR0ExVUVBd3dDVTBJeEpUQWpCZ2txCmhraUc5dzBCQ1FFV0ZuTmhZV1F1WW1WdVlXTm9hVUJuYldGcGJDNWpiMjB3SGhjTk1qUXdOekUzTVRZeE1URTIKV2hjTk1qa3dOekUyTVRZeE1URTJXakJhTVFzd0NRWURWUVFHRXdKR1VqRU1NQW9HQTFVRUNBd0RTVVJHTVE0dwpEQVlEVlFRSERBVlFRVkpKVXpFUU1BNEdBMVVFQ2d3SFFrVk9RVU5JU1RFTk1Bc0dBMVVFQ3d3RVUwRkJSREVNCk1Bb0dBMVVFQXd3RGMzSjJNSUlCSWpBTkJna3Foa2lHOXcwQkFRRUZBQU9DQVE4QU1JSUJDZ0tDQVFFQW5xTTAKK1libnB2Wis1VDZya2Fvd3NCSHdibXN6MUkyMXhacUNrTnRBMW1mL0VSdVhxa2RrNzFxeFRkclgrLzB4MWtDTgpZdmxhM3hNSldaU2c0bmlRck45Qmo1Wkp1WFpWeWl2eG8rZlI2cUNOZmpwZFNldXllMnNRS0E1aC8rckxzOXY0Cnl3Y3l0eW12dW5DTndkdjBRejJyRjBOUWJsQnJzczUzdWNmL2I5WW5SVVNmOE9GZHRFZmJQa0duMmdPRExMVEEKYWtWMFNZaGszeWJ6RCsrcVhPUjdKZW9YMXpVejZpamZ1VDhHcVBSUGt4VlhSd3FjUzZLUFlCdWlLeVJsV3NpWQpKUmpLeWpXVndadDBOWFlkajVGNnhEWWU4T0RNVy9tR1ZIcmUwM1liTW8yWDM5TXBhaW92bnkxQngwVDUyb0hXCkViU0MvVDVHMDB2VU5RYktqd0lEQVFBQk1BMEdDU3FHU0liM0RRRUJDd1VBQTRJQkFRQS9UVGdtSllZRG1TR2EKWnlaL0VoNnVMYUpJWTNRdkNHcThNWTFlRFJsVk5kU0pzdEc3NmpQYmV6d2VlSnVWV2lpTFk0ZXBWYndnYzFZawpVay9QN1VhRzV6MWNWV0thODh6ZndTS1hmWjVCR0MwSjgvMWg0VndiYjJKUWV5aEV6VDdUMWY3UDF6bmg4Q1A3CldqQ29CS2dUZUxpcC9YS3JKNnY4WWFoc1I2cklhamI1YTVmT3pkT3JsbmNuelNPZUdVcE91NHE3V2ovSXRBeGUKL3hOL0VnNzVuU091WXpYa1N5WnZDZWJYellGYUZHNGdNU2hKeDVYcXJWeHUzaWhHNkswYlJrVUVJcXU1dkRPQgpzOGliMFN5ZFlSS0NXUjZTZGZsN1c3UXNFS2dNMTFmazQ0OERhK252UEc1UkxMNm5QYWpCVXl6MU1oSWpBcFljCnBqeFp2aDAwCi0tLS0tRU5EIENFUlRJRklDQVRFLS0tLS0K
  tls.key: LS0tLS1CRUdJTiBQUklWQVRFIEtFWS0tLS0tCk1JSUV2UUlCQURBTkJna3Foa2lHOXcwQkFRRUZBQVNDQktjd2dnU2pBZ0VBQW9JQkFRQ2VvelQ1aHVlbTluN2wKUHF1UnFqQ3dFZkJ1YXpQVWpiWEZtb0tRMjBEV1ovOFJHNWVxUjJUdldyRk4ydGY3L1RIV1FJMWkrVnJmRXdsWgpsS0RpZUpDczMwR1Bsa201ZGxYS0svR2o1OUhxb0kxK09sMUo2N0o3YXhBb0RtSC82c3V6Mi9qTEJ6SzNLYSs2CmNJM0IyL1JEUGFzWFExQnVVR3V5em5lNXgvOXYxaWRGUkovdzRWMjBSOXMrUWFmYUE0TXN0TUJxUlhSSmlHVGYKSnZNUDc2cGM1SHNsNmhmWE5UUHFLTis1UHdhbzlFK1RGVmRIQ3B4TG9vOWdHNklySkdWYXlKZ2xHTXJLTlpYQgptM1ExZGgyUGtYckVOaDd3NE14YitZWlVldDdUZGhzeWpaZmYweWxxS2krZkxVSEhSUG5hZ2RZUnRJTDlQa2JUClM5UTFCc3FQQWdNQkFBRUNnZ0VBVFFJaFJ6aEwzK3NzOHBBWHJXQ1d2Z0lYV3lMRFNGMTZiZkJ4ald4QjcxTVEKcVBkaUNwRVoyRytJUHFrTHpCRy9UYWlNZWcxZUpZZ1NNK0JJc1dlaG82bkZJN1RyR1JMdTFuTzZtN3gvVkl5WAo0enpsNkdwNGZCMGUvTEx1czlNQkM5Q3UxN0FvMkcxdUZ1MW9nMEVKTkZNTmFQK09YZDdBU1U2ZEpCeUlUWHMrClNHREE0RXg4MWJ3RGFCYUs4OW96QWdqOWQ4cGZiWU43QXhvQmYyVGxQK3E4b1dpakpGSjBZazVidXpXRlRNWGYKQ2ZJaDBTUHdPRm50N0Y0N2tHYTgvcDlyVTVHQjdPcUZSV01MZG42Ukd3R0Z2ZzFJK3FKTUZpZzF1bU1lYUx6YgoxTldCUzZLdVFYK2hhMUpyQTBReFZYLzh1VVZrOU1RUUpqUXprdDFuMFFLQmdRRFIxbVhlSGlUQjNGT3hyb211CmZpaytJMW1kem1jS2ZUYyt1ZzkwcmRUc2FZdGc1T2ZCbWNMVVBhT3JVSFNtdGdHMGd2SFBIc0NQano4TUl2Q3IKbFFqdG9yNENIT3hYMUtMalg4UmNGUVJGZUR3VVZScmV0Tkhyb3BRN3N1WHdtQnFaMGdNOWhyVGhTQVBVWVdFOQpYZkhjM0Uzeldza2hJdFg4TjQvRGRsVUJ5d0tCZ1FEQmlWWHZrWlJBelBSOXV0VnF0L0phMDBnZDJ1QlZycDM1CnNKazRDdzBqUk55cHNjeHZaeEZqYXVhbW5OTzBlRTR5RWZycDVqb3JxbFNmdU55T1YrYy92QSs0WmxpcGZ6T1EKL1NQdkg4Uyt3MnF6czltTWZJamdqMEtvdmMyU3pqdW0xRXBoU3BZRXc2NkFHcUpFbERSS0RyQWNJRXlOb0ZWcwpKU2VTYzBXeHpRS0JnQWxHa2ZBMG91bFM1UHc0dSt0VHRsMEIwUWRSeFdwSVNMWGtJYVRGdm1ESTlabE41UlRBCnlFVDdpSTJkRzlyMnRyS1ZDejFkbmFONjhJMkh5ZDI3MDg0MVlITFZkbmtYZEMvYTN1STNKNTR1aDNGYXBicHMKZ2M4SnU4Vzd6Y0JKNlBzZHRuajB5SEFnNzlKbWo1YlgzVVluRXVjTC8xSVFxU2JpQ2QvWkRqN3JBb0dCQUs3dQptTXQ3RmJyZ3hwa2ltQ2JtNzF1akg4dEVmSU5WMnhyR3dpZEM3ZlFVR1RRVkxvai9hMXNtVkNjREYrUkczYjhxCk8xYlJyNENxYStVVzdkeUhuZEVoQmtDUjJkQVMxcVJWK3ZYNERCaTFmNnZBZzRJVlNvOVhUbFJCZ3lBUDR5RXYKUDYvaS8raDhpeXpsWmdpQXdTYXpVZ0dLUEVmRFJaTURubG9rY1RsOUFvR0FIUmJkcW9uTzZ2TUdobWdRMWhhdAp2U2FzWkVQcFpJM2EzUThpVEhTakQ5SU1CQ2gzMlloQmVqY2UrM3h6RklIeWRwRmdGVXp0bnREVXQ0RmkrL3l2CnRrOWlxTC9hc0pHY0pkTDN4YmJ4bUR6dHhPOGlUdjRJQnAyazRIeUlGd0JkVVJjTnlDbFFRQkFqK0xyamFlSHcKcWZ2cDl2NCsxcThrYjFvOHlBQ2xDY3c9Ci0tLS0tRU5EIFBSSVZBVEUgS0VZLS0tLS0K
  ca.crt: LS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tCk1JSUQ0RENDQXNpZ0F3SUJBZ0lVR3VGKzRqUFVwUTFWZytVLzZoQVpiWUVVZEJ3d0RRWUpLb1pJaHZjTkFRRUwKQlFBd2dZQXhDekFKQmdOVkJBWVRBa1pTTVF3d0NnWURWUVFJREFOSlJFWXhEakFNQmdOVkJBY01CVkJCVWtsVApNUkF3RGdZRFZRUUtEQWRDUlU1QlEwaEpNUTB3Q3dZRFZRUUxEQVJUUVVGRU1Rc3dDUVlEVlFRRERBSlRRakVsCk1DTUdDU3FHU0liM0RRRUpBUllXYzJGaFpDNWlaVzVoWTJocFFHZHRZV2xzTG1OdmJUQWVGdzB5TkRBM01UY3gKTmpFeE1UWmFGdzB5T1RBM01UWXhOakV4TVRaYU1JR0FNUXN3Q1FZRFZRUUdFd0pHVWpFTU1Bb0dBMVVFQ0F3RApTVVJHTVE0d0RBWURWUVFIREFWUVFWSkpVekVRTUE0R0ExVUVDZ3dIUWtWT1FVTklTVEVOTUFzR0ExVUVDd3dFClUwRkJSREVMTUFrR0ExVUVBd3dDVTBJeEpUQWpCZ2txaGtpRzl3MEJDUUVXRm5OaFlXUXVZbVZ1WVdOb2FVQm4KYldGcGJDNWpiMjB3Z2dFaU1BMEdDU3FHU0liM0RRRUJBUVVBQTRJQkR3QXdnZ0VLQW9JQkFRQ3ZHeklNWnBOdApOWk5nMU9CZ1h5Y1RZdUt4MjVUalhhUmplWHBpWklsYUg2eW5Fa2FYWmVtT1pmTGZkWHpqY1dobGw3RDl2aExOClM0UWRQRDJjS0Z2UDBIaFVVWTR2UzNpT1BqSSsvaXVVMFZKOE9lZ0NhdmlBYWpTeVV6NXhjNzQ1cGhtZmdub0YKWWNNQTdKdkZNa3NWUDI3ZUVwS3F5dldkSS9zUGVEc0owUE1UOEhJVnFBb1hrckhadTF3a205TUwwaDlWUmR0Qgp2elN6WVZIejNQZVpoQ2U1VEdhYm1oamlVY0ltMFZmZTE4bHhnSUhYb3dGaENka2o0QW4raHl1eFFFTVpjTU4zClBZMGpOMFNUZ3VkODZjazZEeDFHd1RxZ0Jrd2t2TXVOVi9xVGdNdnhOTHZINVBvSEhlb2grY1NKYnV5Tk9JNm4KL1MxM3labmFNU09MQWdNQkFBR2pVREJPTUIwR0ExVWREZ1FXQkJRWHBJQzRlQzFCanFpTVlUTFJDSGZMRXJnTApRVEFmQmdOVkhTTUVHREFXZ0JRWHBJQzRlQzFCanFpTVlUTFJDSGZMRXJnTFFUQU1CZ05WSFJNRUJUQURBUUgvCk1BMEdDU3FHU0liM0RRRUJDd1VBQTRJQkFRQmMxcEpOOUJ5NVFuVWZlM2laWjd0WTlDZ054NFdMVTJwTXdkcmwKaXpYT2xJZzRkYzBqSVA4Zm5DTXNDazIvSThlTnpKeTdHRW1qY1NJeXNIZnpVMHJsMnJpUDdyTE5qdzhmOHlUSwpueGZDaitZdnMzU2YzbEpnQlRRQm95Z2QySU0rQVRQVGhPWDdoL1N1aUtHVzNjbnkrWmpvZVVYZHc5WVhjeEh4CitFT1JuMVNwbWdETzNYRW1UK3VzUDc1b0E0OGVBS2ZycmE0b2k4VWlpYmIwbU9TdW1RdDI5RUZyMmZBTmJzU1AKVlZveWdWTUtERzBWcURpcis5OUM5M2U5eWZ3TzNsYVpoaGVhRHR4TlNINXpwd1h0aUI4SGxEUFVRd2FSNURtVwozODZIaEtFZGdtbVZCSkNGNjVhVFVscUMyVVVGWUlFNUNPdVFna1M0ajFTZEFsOHYKLS0tLS1FTkQgQ0VSVElGSUNBVEUtLS0tLQo=
type: kubernetes.io/tls
---
apiVersion: v1
kind: ConfigMap
metadata:
  name: cp4imq-mywebconfig
  namespace: cp4i
data:
  mqwebuser.xml: "<server><featureManager><feature>appSecurity-2.0</feature></featureManager><sslDefault sslRef=\"mqDefaultSSLConfig\"/><basicRegistry id=\"basic\" realm=\"defaultRealm\"><user name=\"mqadmin\" password=\"Passw0rd!\"/><group name=\"mqadmins\"><member name=\"mqadmin\"/></group></basicRegistry><application-bnd><security-role name=\"MQWebAdmin\"><user name=\"mqadmin\" /><group name=\"mqadmins\" /></security-role></application-bnd></server>"
---
apiVersion: route.openshift.io/v1
kind: Route
metadata:
  name: cp4imq-route
  namespace: cp4i
spec:
  host: cp4imqchl.chl.mq.ibm.com
  to:
    kind: Service
    name: cp4imq-ibm-mq
  port:
    targetPort: 1414
  tls:
    termination: passthrough
---
apiVersion: v1
kind: ConfigMap
metadata:
  name: cp4imq-mqsc-cm
  namespace: cp4i
data:
  cp4imq.mqsc: |
    DEFINE QLOCAL('Q1') REPLACE DEFPSIST(YES) 
    DEFINE CHANNEL('CP4IMQCHL') CHLTYPE(SVRCONN) REPLACE TRPTYPE(TCP) SSLCAUTH(OPTIONAL) SSLCIPH('ANY_TLS12_OR_HIGHER')
    SET CHLAUTH('CP4IMQCHL') TYPE(BLOCKUSER) USERLIST(NOBODY) ACTION(ADD)
---
apiVersion: mq.ibm.com/v1beta1
kind: QueueManager
metadata:
  name: cp4imq
  namespace: cp4i
spec:
  license:
    accept: true
    license: L-JTPV-KYG8TF
    use: "NonProduction"
  pki:
    keys:
      - name: cp4imq
        secret:
          secretName: cp4imq-secret
          items:
            - tls.key
            - tls.crt
            - ca.crt
  queueManager:
    name: CP4IMQ
    resources:
      limits:
        cpu: 500m
      requests:
        cpu: 500m
    storage:
      queueManager:
        type: ephemeral
    availability:
      type: SingleInstance
    mqsc:
      - configMap:
          name: cp4imq-mqsc-cm
          items:
            - cp4imq.mqsc   
  template:
    pod:
      containers:
        - env:
            - name: MQSNOAUT
              value: 'yes'
          name: qmgr
  version: 9.4.0.0-r2
  web:
    console:
      authentication:
        provider: manual
      authorization:
        provider: manual
    manualConfig:
      configMap: 
        name: cp4imq-mywebconfig
    enabled: true